package io.openaev.rest.vulnerability.form;

import com.fasterxml.jackson.annotation.JsonProperty;
import io.swagger.v3.oas.annotations.media.Schema;
import jakarta.validation.constraints.DecimalMax;
import jakarta.validation.constraints.DecimalMin;
import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.NotNull;
import java.math.BigDecimal;
import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
@Schema(description = "Payload to create a Vulnerabilty")
public class VulnerabilityCreateInput extends VulnerabilityInput {

  @NotBlank
  @JsonProperty("vulnerability_external_id")
  @Schema(description = "External Unique Vulnerabilty Identifier", example = "CVE-2024-0001")
  private String externalId;

  @NotNull
  @DecimalMin("0.0")
  @DecimalMax("10.0")
  @JsonProperty("vulnerability_cvss_v31")
  @Schema(description = "CVSS score", example = "7.5", minimum = "0.0", maximum = "10.0")
  private BigDecimal cvssV31;
}
