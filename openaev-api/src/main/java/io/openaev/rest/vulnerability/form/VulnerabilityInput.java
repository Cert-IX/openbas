package io.openaev.rest.vulnerability.form;

import com.fasterxml.jackson.annotation.JsonProperty;
import io.openaev.database.model.Vulnerability;
import io.swagger.v3.oas.annotations.media.Schema;
import jakarta.persistence.EnumType;
import jakarta.persistence.Enumerated;
import java.time.Instant;
import java.util.List;
import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
@Schema(description = "Common base input for vulnerability creation and update")
public class VulnerabilityInput {

  @JsonProperty("vulnerability_source_identifier")
  @Schema(description = "Identifier of the vulnerability source", example = "MITRE")
  private String sourceIdentifier;

  @JsonProperty("vulnerability_published")
  @Schema(description = "Publication date of the vulnerability")
  private Instant published;

  @JsonProperty("vulnerability_description")
  @Schema(description = "Description of the vulnerability")
  private String description;

  @Enumerated(EnumType.STRING)
  @JsonProperty("vulnerability_vuln_status")
  @Schema(description = "Vulnerability status", example = "ANALYZED")
  private Vulnerability.VulnerabilityStatus vulnStatus;

  @JsonProperty("vulnerability_cisa_exploit_add")
  @Schema(description = "Date when CISA added the vulnerability to the exploited list")
  private Instant cisaExploitAdd;

  @JsonProperty("vulnerability_cisa_action_due")
  @Schema(description = "Date when action is due by CISA")
  private Instant cisaActionDue;

  @JsonProperty("vulnerability_cisa_required_action")
  @Schema(description = "Action required by CISA")
  private String cisaRequiredAction;

  @JsonProperty("vulnerability_cisa_vulnerability_name")
  @Schema(description = "Vulnerability name used by CISA")
  private String cisaVulnerabilityName;

  @JsonProperty("vulnerability_remediation")
  @Schema(description = "Suggested remediation")
  private String remediation;

  @JsonProperty("vulnerability_reference_urls")
  @Schema(description = "List of reference URLs")
  private List<String> referenceUrls;

  @JsonProperty("vulnerability_cwes")
  @Schema(description = "List of linked CWEs")
  private List<CweInput> cwes;
}
