package io.openaev.rest.vulnerability.form;

import com.fasterxml.jackson.annotation.JsonProperty;
import io.openaev.database.model.Vulnerability;
import io.swagger.v3.oas.annotations.media.Schema;
import jakarta.persistence.EnumType;
import jakarta.persistence.Enumerated;
import java.time.Instant;
import java.util.List;
import lombok.Getter;
import lombok.Setter;
import lombok.experimental.SuperBuilder;

@Setter
@Getter
@SuperBuilder
@Schema(description = "Full vulnerability output including references and CWEs")
public class VulnerabilityOutput extends VulnerabilitySimple {

  @JsonProperty("vulnerability_source_identifier")
  @Schema(description = "Source identifier")
  private String sourceIdentifier;

  @JsonProperty("vulnerability_description")
  @Schema(description = "Detailed vulnerability description")
  private String description;

  @Enumerated(EnumType.STRING)
  @JsonProperty("vulnerability_vuln_status")
  @Schema(description = "Status of the vulnerability")
  private Vulnerability.VulnerabilityStatus vulnStatus;

  @JsonProperty("vulnerability_cisa_exploit_add")
  @Schema(description = "CISA exploit addition date")
  private Instant cisaExploitAdd;

  @JsonProperty("vulnerability_cisa_action_due")
  @Schema(description = "CISA required action due date")
  private Instant cisaActionDue;

  @JsonProperty("vulnerability_cisa_required_action")
  @Schema(description = "Action required by CISA")
  private String cisaRequiredAction;

  @JsonProperty("vulnerability_cisa_vulnerability_name")
  @Schema(description = "Name used by CISA for the vulnerability")
  private String cisaVulnerabilityName;

  @JsonProperty("vulnerability_remediation")
  @Schema(description = "Remediation suggestions")
  private String remediation;

  @JsonProperty("vulnerability_reference_urls")
  @Schema(description = "External references")
  private List<String> referenceUrls;

  @JsonProperty("vulnerability_cwes")
  @Schema(description = "List of CWE outputs")
  private List<CweOutput> cwes;
}
